Building DAG of jobs...
Using shell: /bin/bash
Provided cores: 64
Rules claiming more threads will be scaled down.
Conda environments: ignored
Job stats:
job                  count    min threads    max threads
-----------------  -------  -------------  -------------
align_to_amr             1              4              4
all                      1              1              1
kraken                   1              4              4
maxbin2                  1              1              1
pileup                   1              1              1
pileup_install           1              1              1
prokka_bin               1              4              4
resistome_results        1              1              1
run_resistome            1              1              1
total                    9              1              4

Select jobs to execute...

[Thu Jun  1 14:20:50 2023]
rule align_to_amr:
    input: amr/megares.fasta.amb, amr/megares.fasta.ann, amr/megares.fasta.bwt, amr/megares.fasta.pac, amr/megares.fasta.sa, amr/megares.fasta, results/S1_test/trimmomatic/S1_test_forward_paired.fq.gz, results/S1_test/trimmomatic/S1_test_reverse_paired.fq.gz
    output: results/S1_test/MEGARes/AlignToAMR/S1_test.amr.alignment.sam
    jobid: 20
    reason: Updated input files: amr/megares.fasta.bwt, amr/megares.fasta, amr/megares.fasta.sa, amr/megares.fasta.pac, amr/megares.fasta.amb, amr/megares.fasta.ann
    wildcards: sample=S1_test
    threads: 4
    resources: tmpdir=/tmp


[Thu Jun  1 14:20:50 2023]
rule pileup_install:
    output: results/bin/bbmap/pileup.sh
    jobid: 15
    reason: Missing output files: results/bin/bbmap/pileup.sh
    resources: tmpdir=/tmp


[Thu Jun  1 14:20:50 2023]
rule kraken:
    input: results/S1_test/trimmomatic/S1_test_forward_paired.fq.gz, results/S1_test/trimmomatic/S1_test_reverse_paired.fq.gz
    output: results/S1_test/kraken/S1_test_report.txt, results/S1_test/kraken/S1_test_report.krona, results/S1_test/kraken/S1_test_report.html
    log: results/S1_test/kraken/log-stdout.txt, results/S1_test/kraken/log-stderr.txt
    jobid: 2
    reason: Missing output files: results/S1_test/kraken/S1_test_report.html
    wildcards: sample=S1_test
    threads: 4
    resources: tmpdir=/tmp

[Thu Jun  1 14:20:51 2023]
Finished job 20.
1 of 9 steps (11%) done
Select jobs to execute...

[Thu Jun  1 14:20:51 2023]
rule run_resistome:
    input: build_resistome.done, results/S1_test/MEGARes/AlignToAMR/S1_test.amr.alignment.sam, amr/megares.fasta, amr/megares_annotations.csv
    output: results/S1_test/MEGARes/RunResistome/S1_test.gene.tsv, results/S1_test/MEGARes/RunResistome/S1_test.group.tsv, results/S1_test/MEGARes/RunResistome/S1_test.mechanism.tsv, results/S1_test/MEGARes/RunResistome/S1_test.class.tsv
    jobid: 18
    reason: Input files updated by another job: results/S1_test/MEGARes/AlignToAMR/S1_test.amr.alignment.sam
    wildcards: sample=S1_test
    resources: tmpdir=/tmp

[Thu Jun  1 14:20:52 2023]
Finished job 18.
2 of 9 steps (22%) done
Select jobs to execute...

[Thu Jun  1 14:20:52 2023]
rule resistome_results:
    input: results/S1_test/MEGARes/RunResistome/S1_test.gene.tsv
    output: results/S1_test/MEGARes/ResistomeResults/AMR_analytic_matrix.csv
    jobid: 17
    reason: Input files updated by another job: results/S1_test/MEGARes/RunResistome/S1_test.gene.tsv
    wildcards: sample=S1_test
    resources: tmpdir=/tmp

[Thu Jun  1 14:20:52 2023]
Finished job 17.
3 of 9 steps (33%) done
[Thu Jun  1 14:20:53 2023]
Finished job 15.
4 of 9 steps (44%) done
Select jobs to execute...

[Thu Jun  1 14:20:53 2023]
rule pileup:
    input: results/bin/bbmap/pileup.sh, results/S1_test/bowtie2/S1_test.sam
    output: results/S1_test/pileup/S1_test_cov.txt, results/S1_test/pileup/S1_test_abundance.txt
    jobid: 14
    reason: Updated input files: results/S1_test/bowtie2/S1_test.sam; Input files updated by another job: results/bin/bbmap/pileup.sh
    wildcards: sample=S1_test
    resources: tmpdir=/tmp

[Thu Jun  1 14:20:53 2023]
Finished job 14.
5 of 9 steps (56%) done
Select jobs to execute...

[Thu Jun  1 14:20:53 2023]
rule maxbin2:
    input: results/S1_test/assembly/best_assembly/final.contigs.fa, results/S1_test/pileup/S1_test_abundance.txt
    output: results/S1_test/maxbin, results/S1_test/maxbin/list_bins.txt
    jobid: 13
    reason: Missing output files: results/S1_test/maxbin; Input files updated by another job: results/S1_test/pileup/S1_test_abundance.txt
    wildcards: sample=S1_test
    resources: tmpdir=/tmp

[Thu Jun  1 14:20:55 2023]
Error in rule maxbin2:
    jobid: 13
    input: results/S1_test/assembly/best_assembly/final.contigs.fa, results/S1_test/pileup/S1_test_abundance.txt
    output: results/S1_test/maxbin, results/S1_test/maxbin/list_bins.txt
    conda-env: /storage1/victor/speedypipe4meta/.snakemake/conda/4e3c652eb1f0884dff60385860f576a5_
    shell:
        
            /home/victor/storage/MaxBin-2.2.7/run_MaxBin.pl -min_contig_length 300 -thread 1 -contig results/S1_test/assembly/best_assembly/final.contigs.fa -out results/S1_test/maxbin/maxbin -abund results/S1_test/pileup/S1_test_abundance.txt
            ls results/S1_test/maxbin/*.fasta > results/S1_test/maxbin/list_bins.txt
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Removing output files of failed job maxbin2 since they might be corrupted:
results/S1_test/maxbin
[Thu Jun  1 14:21:51 2023]
Finished job 2.
6 of 9 steps (67%) done
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: .snakemake/log/2023-06-01T142049.601398.snakemake.log
